<div class="measurement-form-container">
    <form [formGroup]="form" (ngSubmit)="handleSubmit()">
        <div class="form-header">
            <h2>Nueva Medición</h2>
            <p>Registra las medidas corporales del cliente</p>
        </div>

        <div class="form-grid">
            <!-- Weight & Height -->
            <div class="form-group">
                <label for="weight">Peso (kg) *</label>
                <input type="number" id="weight" formControlName="weight" placeholder="70" step="0.1"
                    class="form-input" />
                <span class="error-message" *ngIf="form.get('weight')?.invalid && form.get('weight')?.touched">
                    Ingresa un peso válido (20-300 kg)
                </span>
            </div>

            <div class="form-group">
                <label for="height">Altura (cm) *</label>
                <input type="number" id="height" formControlName="height" placeholder="170" step="0.1"
                    class="form-input" />
                <span class="error-message" *ngIf="form.get('height')?.invalid && form.get('height')?.touched">
                    Ingresa una altura válida (100-250 cm)
                </span>
            </div>

            <!-- BMI Display -->
            <div class="bmi-display" *ngIf="calculatedBMI()">
                <div class="bmi-value" [style.color]="getBMIColor(calculatedBMI()!)">
                    {{ calculatedBMI() }}
                </div>
                <div class="bmi-label">IMC</div>
                <div class="bmi-category" [style.color]="getBMIColor(calculatedBMI()!)">
                    {{ getBMICategory(calculatedBMI()!) }}
                </div>
            </div>

            <!-- Body Fat Percentage -->
            <div class="form-group">
                <label for="bodyFat">% Grasa Corporal</label>
                <input type="number" id="bodyFat" formControlName="bodyFatPercentage" placeholder="15" step="0.1"
                    class="form-input" />
            </div>

            <!-- Muscle Mass -->
            <div class="form-group">
                <label for="muscleMass">Masa Muscular (kg)</label>
                <input type="number" id="muscleMass" formControlName="muscleMass" placeholder="50" step="0.1"
                    class="form-input" />
            </div>

            <!-- Visceral Fat -->
            <div class="form-group">
                <label for="visceralFat">Grasa Visceral</label>
                <input type="number" id="visceralFat" formControlName="visceralFat" placeholder="5" step="1"
                    class="form-input" />
            </div>

            <!-- Metabolic Age -->
            <div class="form-group">
                <label for="metabolicAge">Edad Metabólica</label>
                <input type="number" id="metabolicAge" formControlName="metabolicAge" placeholder="30" step="1"
                    class="form-input" />
            </div>

            <!-- Notes -->
            <div class="form-group full-width">
                <label for="notes">Notas</label>
                <textarea id="notes" formControlName="notes" placeholder="Observaciones adicionales..." rows="3"
                    class="form-input"></textarea>
            </div>
        </div>

        <div class="form-actions">
            <button type="button" class="btn-secondary" (click)="handleCancel()">
                Cancelar
            </button>
            <button type="submit" class="btn-primary" [disabled]="form.invalid || !calculatedBMI()">
                Guardar Medición
            </button>
        </div>
    </form>
</div>